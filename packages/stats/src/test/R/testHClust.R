
library(datasets)
library(hamcrest)

test.hclust <- function() {
    hc <- hclust(dist(USArrests), "ave")
    
    expectedMerge <- cbind(
            as.integer(c(-15, -17, -14, -13, -35, -36, -7, -19, -49, -50, -48, -21,  -27, -4, -37, -34, -22, 3, -3, 
                -6, -12,  5, -20, -1, -47, -8,  4, -23, -25, 21, -24, -39, -10, 26, 25, 16, -5, -2, 29, 11, -9,
                34, -11, 37,  35, 30, 41, 45, 47)),
            as.integer(c(-29, -26, -16, -32, -44, -46, -38, -41, 1, 6, 8, -30, 2, -42,  10, -45, -28, 7, -31, -43,
             13, 18, 19, -18, 15, 24, 17, 9, 14,  22, -40, 12, 20, 27, 32, 28, 23, 31, 33, 36, -33, 38, 40, 42,  39, 
             43, 44, 46, 48)))
              
    assertThat(hc$merge, identicalTo(expectedMerge))
}